# CommunityRobustness
Studying robustness of community partitions in synthetic and empirical networks under edge addition using community detection algorithms



## Requirement
Our computation is launched on Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-135-generic x86_64) with 40 cores.

All dependencies for running our experiments are provided in `env.yml`. You can set up a conda environment using commands like the following:  

```
conda env create -n robustness --file env.yml
conda activate robustness
```



## Reproducing Experiments

Both the synthetic experiments using the Lancichinetti-Fortunato-Radicch (LFR) benchmark graphs and the empirical experiments can be reproduced with

`python driver.py`

Then follow the popped up inquiries to provide user inputs correspondingly. Hit `enter` each time to proceed. The algorithm will run automatically after all inputs required are provided appropriately.



> <u>Input instruction:</u>
>
> ​	For the inquiry `Generate synthetic network or use empirical network`: Type either `synthetic` or `empirical` to specify whether you want to run experiments on the LFR benchmark or using emprical dataset which you need to provide a path to at a later step.
>
> 
>
> ​	* If **synthetic**:
>
> ​		`Number of nodes`: Type an integer number to specify how many nodes the graph generated by the LFR benchmark algorithm should have.
>
> ​		`Community detection algorithm`: Type `louvain` for Louvain, or `leiden` for Leiden, or `infomap` for Infomap, or `label` for Label Propagation.
>
> ​		`Average degree of the nodes`: Type an integer or hit `enter` to use the default value 25. This is a parameter given to the LFR benchmark graph algorithm to generate an initial graph with the given average degree.
>
> ​		`Minimum community size`: Type an integer or hit `enter` to use the default value 50. This is a parameter given to the LFR benchmark graph algorithm to generate an initial graph with planted communities whose minimum size is as specified.
>
> ​		`How to randomly select edges to append?`: This is to select the edge addition rule for perturbing the benchmark graph. All additional edges are selected from the set of non-existing edges and multi-edges are prohibited. Type `uniform` for uniformly at random selection, `inter` for restricting to the inter-community edges (i.e. edges across different initial communities), `intra` for restricting to intra-community edges (i.e. edges connected to nodes within the same initial community).
>
> ​		`Add up to how many times of original number of edges`: Provide a float or or hit `enter` to use the default value 10. The experiment will run up to when the specified times (X) of original number of edges are added over 50 steps. Specifically, it adds X/50, 2X/50, ..., X times of original number of edges at step 1, 2, ..., 50 respectively. The selections at different steps are independent from each other and only based on the initial graph. Also, for each number of edges added, we repeat 50 times of the selection independently.
>
> 
>
> ​	* If **empirical**:
>
> ​		`Path to network data`: provide path to the empirical dataset to be used for the computational experiment. Only type the remaining part of the path following the current working directory displayed. To use a provided example, type like `Empirical_Dataset/ia-radoslaw-email_N74.txt`. [Note that our experiment requires the empirical network dataset to be pre-cleaned so that it satisfies: (1) There are 3 columns, named as `From`, `To` and `Time`, corresponding to the source node, the target node and the corresponding timestamp for the emerging edge. (2) The node IDs are consecutive integers starting from 0. (3) There also should be no repeated edges. (4)The rows are sorted by time.] 
>
> ​		`Community detection algorithm`: Type `louvain` for Louvain, or `leiden` for Leiden, or `infomap` for Infomap, or `lpm` for Label Propagation.
>
> ​		`How many time steps to slice?`: Provide an integer number or hit `enter` to use the default value, maximal number of steps possible divided by 10. This determines how many steps the experiment will run over all available time steps given by the dataset.
>
> ​		`Number of partitions for initial network?`: Type an integer or hit `enter` to use the default value 20. This is a parameter given to the fast consensus algorithm which is used to detect initial partitions.
>
> ​		`Number of realizations per time step?`: Type an integer or hit `enter` to use the default value 10. This is the number of times the clustering algorithm will rurn at each step independently.
>
> 



The results are written into `json` data files. If running synthetic experiments on LFR benchmark, the result files will be in `./Data/LFR_network/` and the file names will start with `results_`. When running on empirical datasets, information on the initial partition and computational results over timesteps are recorded in separate folders, which can be found in the directory `./Data/empirical_network/`. These corresonding directories and files are generated automatically by the algorithm.



### Datasets

We provide 3 empirical network datasets in `./Empirical_Dataset/` as examples to run empirical experiments. These data are pre-processed and cleaned from the following original datasets obtained from online data repositories:

1. R. Rossi and N. Ahmed, Ia-radoslaw-email, https://networkrepository.com/ia-radoslaw-email.php
2. J. Kunegis, Enron, http://konect.cc/networks/enron
3. J. Leskovec, email-eu-core temporal network, http://snap.stanford.edu/data/email-Eu-core-temporal.html





### References

Our code uses the following packages/algorithms developed by the others:



#### * LFR benchmark graph 

```
@article{PhysRevE.78.046110,
  title = {Benchmark graphs for testing community detection algorithms},
  author = {Lancichinetti, Andrea and Fortunato, Santo and Radicchi, Filippo},
  journal = {Phys. Rev. E},
  volume = {78},
  issue = {4},
  pages = {046110},
  numpages = {5},
  year = {2008},
  month = {Oct},
  publisher = {American Physical Society},
  doi = {10.1103/PhysRevE.78.046110},
  url = {https://link.aps.org/doi/10.1103/PhysRevE.78.046110}
}
```

The package is provided on the author's webpage: https://www.santofortunato.net/resources



#### * Lancichinetti's program as a collection of clustering algorithms (specifically used Louvain, Infomap and Label Propagation)

The program itself is an implementation of the paper "Directed, weighted and overlapping benchmark graphs for community detection algorithms", written by Andrea Lancichinetti and Santo Fortunato. 

The package is provided on Santo Fortunato's Webpage https://www.santofortunato.net/resources where you can find the corresponding download link https://drive.google.com/file/d/1Z_ksrI559cSp6db3hrKhe1BmnyHGuIxa/view



#### * Leiden algorithm

```
@article{Traag_2019,
	doi = {10.1038/s41598-019-41695-z},
	url = {https://doi.org/10.1038%2Fs41598-019-41695-z},
	year = {2019},
	month = {mar}, 
	publisher = {Springer Science and Business Media {LLC}},
	volume = {9},
	number = {1},
	author = {V. A. Traag and L. Waltman and N. J. van Eck},	  
	title = {From Louvain to Leiden: guaranteeing well-connected communities},	  
	journal = {Scientific Reports}
}
```

Leiden package GitHub page: https://github.com/CWTSLeiden/networkanalysis



#### * Fast Consensus

```
@article{PhysRevE.99.042301,
  title = {Fast consensus clustering in complex networks},
  author = {Tandon, Aditya and Albeshri, Aiiad and Thayananthan, Vijey and Alhalabi, Wadee and Fortunato, Santo},
  journal = {Phys. Rev. E},
  volume = {99},
  issue = {4},
  pages = {042301},
  numpages = {5},
  year = {2019},
  month = {Apr},
  publisher = {American Physical Society},
  doi = {10.1103/PhysRevE.99.042301},
  url = {https://link.aps.org/doi/10.1103/PhysRevE.99.042301}
}
```

Paper's corresponding GitHub page: https://github.com/kaiser-dan/fastconsensus
